@page
@model BwMelder.Pages.Crews.IndexModel

@{
    ViewData["Title"] = "Nominierte Mannschaften";
}

<h1>Nominierte Mannschaften</h1>
<p>
    Nominierungen geben an, welcher Verein in welchem Rennen eine Mannschaft stellt.
    Nachdem eine Mannschaft nominiert wurde, können Sportler und Heimtrainer in den Mannschaftsdetails eingetragen werden.
</p>
<p>
    <a class="btn btn-primary" asp-page="Create">Neue Nominierung anlegen</a>
    <a class="btn btn-link" asp-page="../Races/Index">Rennen verwalten</a>
</p>
<table class="table">
    <thead>
        <tr>
            <th>
                @Html.DisplayNameFor(model => model.Crews[0].Race)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Crews[0].ClubName)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Crews[0].Athletes)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Crews[0].HomeCoach)
            </th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        @foreach (var crew in Model.Crews)
        {
            // Color-code the athlete count to show if the crew is complete or not.
            // Compare the actual athlete count of the crew with the expected athlete count according to the race definition.
            var athleteStatusClass = (crew.Athletes.Count, crew.Race.AthleteCount) switch
            {
                // No athletes were added yet, red highlight.
                (0, _) => "table-danger",
                // Some were added, but not all of them, yellow highlight.
                var (x, y) when x < y => "table-warning",
                // All were added, green highlight.
                var (x, y) when x == y => "table-success",
                (_, _) => ""
            };
            <tr>
                <td>
                    @Html.DisplayFor(modelItem => crew.Race.FullName)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => crew.ClubName)
                </td>
                <td class="@athleteStatusClass">
                    @crew.Athletes.Count von @crew.Race.AthleteCount
                </td>
                <td>
                    @Html.DisplayFor(modelItem => crew.HomeCoach.FullName)
                </td>
                <td>
                    <a asp-page="./Details" asp-route-id="@crew.Id">Zur Mannschaft</a> |
                    <a asp-page="./Edit" asp-route-id="@crew.Id">Bearbeiten</a> |
                    <a class="text-danger" asp-page="./Delete" asp-route-id="@crew.Id">Löschen</a>
                </td>
            </tr>
        }
    </tbody>
</table>

<p>
    Ein Überblick über die gemeldeten Sportler je Boot gibt es in der <a asp-page="../Reports/Entries">Meldeübersicht</a>.
</p>